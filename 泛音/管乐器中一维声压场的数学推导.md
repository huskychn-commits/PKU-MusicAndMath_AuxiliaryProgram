# 管乐器中一维声压场的数学推导

## 1. Webster方程（喇叭方程）的推导

### 1.1 从一般声场方程出发

对于理想流体中的小振幅声波，声压 $p(\mathbf{r}, t)$ 满足波动方程：

$$
\nabla^2 p - \frac{1}{c^2} \frac{\partial^2 p}{\partial t^2} = 0
$$

其中 $c$ 是声速。

对于一维喇叭（截面积沿轴向变化），我们假设：
1. 声波沿轴向（$x$ 方向）传播
2. 横截面上声压均匀分布
3. 喇叭截面积 $S(x)$ 是轴向坐标 $x$ 的函数

考虑喇叭内的一小段流体元，质量守恒和动量守恒给出：

**连续性方程**：
$$
\frac{\partial (\rho S)}{\partial t} + \frac{\partial (\rho u S)}{\partial x} = 0
$$

**动量方程**（欧拉方程线性化）：
$$
\rho_0 \frac{\partial u}{\partial t} = -\frac{\partial p}{\partial x}
$$

其中：
- $\rho = \rho_0 + \rho'$，$\rho_0$ 是静态密度，$\rho'$ 是密度扰动
- $u$ 是质点速度（轴向分量）
- $p$ 是声压

### 1.2 状态方程和线性化

对于理想气体，状态方程为：
$$
p = p_0 + c^2 \rho'
$$

其中 $c^2 = \gamma p_0 / \rho_0$。

线性化连续性方程（忽略二阶小量）：
$$
S \frac{\partial \rho'}{\partial t} + \rho_0 \frac{\partial (uS)}{\partial x} = 0
$$

利用状态方程 $\rho' = p/c^2$，得到：
$$
\frac{S}{c^2} \frac{\partial p}{\partial t} + \rho_0 \frac{\partial (uS)}{\partial x} = 0
$$

### 1.3 推导Webster方程

对连续性方程关于时间求导：
$$
\frac{S}{c^2} \frac{\partial^2 p}{\partial t^2} + \rho_0 \frac{\partial}{\partial x} \left( S \frac{\partial u}{\partial t} \right) = 0
$$

代入动量方程 $\frac{\partial u}{\partial t} = -\frac{1}{\rho_0} \frac{\partial p}{\partial x}$：
$$
\frac{S}{c^2} \frac{\partial^2 p}{\partial t^2} + \rho_0 \frac{\partial}{\partial x} \left( S \cdot \left( -\frac{1}{\rho_0} \frac{\partial p}{\partial x} \right) \right) = 0
$$

简化得：
$$
\frac{S}{c^2} \frac{\partial^2 p}{\partial t^2} - \frac{\partial}{\partial x} \left( S \frac{\partial p}{\partial x} \right) = 0
$$

即：
$$
\frac{\partial}{\partial x} \left( S(x) \frac{\partial p}{\partial x} \right) - \frac{S(x)}{c^2} \frac{\partial^2 p}{\partial t^2} = 0
$$

这就是**Webster喇叭方程**。

### 1.4 分离变量法

设解为 $p(x, t) = X(x) T(t)$，代入Webster方程：

$$
T(t) \frac{d}{dx} \left( S(x) \frac{dX}{dx} \right) - \frac{S(x) X(x)}{c^2} \frac{d^2 T}{dt^2} = 0
$$

除以 $S(x) X(x) T(t)$：

$$
\frac{1}{S(x) X(x)} \frac{d}{dx} \left( S(x) \frac{dX}{dx} \right) = \frac{1}{c^2 T(t)} \frac{d^2 T}{dt^2}
$$

左边仅是 $x$ 的函数，右边仅是 $t$ 的函数，因此等于常数。设该常数为 $-k^2$（$k$ 为波数）：

**时间部分**：
$$
\frac{d^2 T}{dt^2} + \omega^2 T = 0, \quad \omega = ck
$$

解为 $T(t) = e^{\pm i\omega t}$。根据用户要求，取 $T(t) = e^{i\omega t}$ 时间约定。

**空间部分**：
$$
\frac{d}{dx} \left( S(x) \frac{dX}{dx} \right) + k^2 S(x) X = 0
$$

这就是分离变量后 $X(x)$ 满足的方程。

### 1.5 无量纲化

令 $\rho_0 = 1$，$c = 1$（即选择特征密度和特征声速为单位值）。此时：

- 波数 $k = \omega/c = \omega$
- Webster方程简化为：

$$
\frac{d}{dx} \left( S(x) \frac{dX}{dx} \right) + \omega^2 S(x) X = 0
$$

其中 $x$ 仍为有量纲长度，但若进一步引入特征长度 $L$（如喇叭长度），令 $\xi = x/L$，$S(\xi) = S(x)/S_0$（$S_0$ 为特征面积），则方程可完全无量纲化。因此最终无量纲方程为：

$$
\frac{d}{d\tilde{x}} \left( \tilde{S}(\tilde{x}) \frac{dX}{d\tilde{x}} \right) + \tilde{k}^2 \tilde{S}(\tilde{x}) X = 0
$$

其中 $\tilde{x} = x/L$，$\tilde{S} = S/S_0$，$\tilde{k} = kL = \omega L/c$。

---

## 2. 辐射阻抗与开口边界条件

### 2.1 辐射阻抗的定义

辐射阻抗 $Z$ 定义为开口处声压 $P$ 与体积流速 $U$ 的比值：

$$
Z = \frac{P}{U}
$$

对于圆形开口，体积流速 $U = v \cdot S_{\text{口}}$，其中 $v$ 是开口处空气质点的平均速度，$S_{\text{口}}$ 是开口面积。

另一种常用定义是声阻抗率 $z = P/v$，即声压与质点速度的比值。两者关系为 $Z = z / S_{\text{口}}$。

### 2.2 圆形平面活塞模型

#### 2.2.1 问题描述

考虑半径为 $a$ 的圆形平面活塞，安装在无限大刚性障板上，在均匀流体（密度 $\rho_0$，声速 $c$）中作简谐振动。活塞表面法向速度均匀分布，复振幅为 $v_0$，时间依赖为 $e^{i\omega t}$。波数 $k = \omega/c$。

在活塞前方半空间（$z \ge 0$）求解声场。声压 $p$ 满足亥姆霍兹方程：

$$
(\nabla^2 + k^2)p = 0
$$

边界条件为：
1. 在 $z=0$ 平面上，法向质点速度 $v_z(\rho,0) = v_0$（对 $\rho \le a$），$v_z(\rho,0) = 0$（对 $\rho > a$）。
2. 无穷远处满足索末菲辐射条件。

由于轴对称，声压与方位角无关，采用柱坐标 $(\rho,\phi,z)$。

#### 2.2.2 速度势方法

引入速度势 $\Phi$，使得声压 $p = i\omega\rho_0\Phi$，质点速度 $\mathbf{v} = \nabla\Phi$。则 $\Phi$ 也满足亥姆霍兹方程：

$$
(\nabla^2 + k^2)\Phi = 0
$$

边界条件转化为：
$$
\left.\frac{\partial\Phi}{\partial z}\right|_{z=0} = 
\begin{cases}
v_0, & \rho \le a \\
0, & \rho > a
\end{cases}
$$

#### 2.2.3 汉克尔变换解

由于轴对称，可对径向坐标 $\rho$ 作零阶汉克尔变换。定义变换对：

$$
\tilde{\Phi}(\lambda,z) = \int_0^\infty \Phi(\rho,z) J_0(\lambda\rho) \rho d\rho
$$

$$
\Phi(\rho,z) = \int_0^\infty \tilde{\Phi}(\lambda,z) J_0(\lambda\rho) \lambda d\lambda
$$

亥姆霍兹方程在变换域中变为：

$$
\left(\frac{d^2}{dz^2} + k^2 - \lambda^2\right)\tilde{\Phi}(\lambda,z) = 0
$$

其解在 $z \ge 0$ 区域为：

$$
\tilde{\Phi}(\lambda,z) = A(\lambda) e^{i\sqrt{k^2-\lambda^2}z}
$$

其中取根号 $\sqrt{k^2-\lambda^2}$ 的虚部非负以保证辐射条件。

#### 2.2.4 边界条件应用

在 $z=0$ 处，速度边界条件的汉克尔变换为：

$$
\left.\frac{\partial\tilde{\Phi}}{\partial z}\right|_{z=0} = \int_0^\infty \frac{\partial\Phi}{\partial z}\Big|_{z=0} J_0(\lambda\rho) \rho d\rho
$$

已知 $\frac{\partial\Phi}{\partial z}\Big|_{z=0} = v_0$（$\rho \le a$）且 $=0$（$\rho > a$），故：

$$
\left.\frac{\partial\tilde{\Phi}}{\partial z}\right|_{z=0} = v_0 \int_0^a J_0(\lambda\rho) \rho d\rho
$$

利用积分公式 $\int_0^a J_0(\lambda\rho) \rho d\rho = \frac{a}{\lambda} J_1(\lambda a)$，得：

$$
\left.\frac{\partial\tilde{\Phi}}{\partial z}\right|_{z=0} = v_0 \frac{a}{\lambda} J_1(\lambda a)
$$

另一方面，由 $\tilde{\Phi}(\lambda,z) = A(\lambda) e^{i\sqrt{k^2-\lambda^2}z}$ 可得：

$$
\left.\frac{\partial\tilde{\Phi}}{\partial z}\right|_{z=0} = i\sqrt{k^2-\lambda^2} A(\lambda)
$$

因此：

$$
A(\lambda) = \frac{v_0 a J_1(\lambda a)}{i\lambda \sqrt{k^2-\lambda^2}}
$$

#### 2.2.5 声压表达式

速度势为：

$$
\Phi(\rho,z) = \frac{v_0 a}{i} \int_0^\infty \frac{J_1(\lambda a) J_0(\lambda\rho)}{\lambda \sqrt{k^2-\lambda^2}} e^{i\sqrt{k^2-\lambda^2}z} \lambda d\lambda
$$

即：

$$
\Phi(\rho,z) = v_0 a \int_0^\infty \frac{J_1(\lambda a) J_0(\lambda\rho)}{\sqrt{k^2-\lambda^2}} e^{i\sqrt{k^2-\lambda^2}z} d\lambda
$$

声压为：

$$
p(\rho,z) = i\omega\rho_0 \Phi(\rho,z) = i\omega\rho_0 v_0 a \int_0^\infty \frac{J_1(\lambda a) J_0(\lambda\rho)}{\sqrt{k^2-\lambda^2}} e^{i\sqrt{k^2-\lambda^2}z} d\lambda
$$

#### 2.2.6 远场近似与辐射阻抗

在远场（$r = \sqrt{\rho^2+z^2} \to \infty$），可用稳相法导出：

$$
p(r,\theta) \approx \frac{i\omega\rho_0 v_0 a^2}{2r} \left[ \frac{2J_1(ka\sin\theta)}{ka\sin\theta} \right] e^{ikr}
$$

其中 $\theta$ 为观察方向与 $z$ 轴的夹角。

活塞表面的平均声压为：

$$
P_{\text{avg}} = \frac{1}{\pi a^2} \int_0^a p(\rho,0) 2\pi\rho d\rho
$$

辐射阻抗率定义为 $z = P_{\text{avg}} / v_0$，计算得：

$$
z = R + iX
$$

其中：
- 辐射阻 $R = \rho_0 c \left[ 1 - \frac{J_1(2ka)}{ka} \right]$
- 辐射抗 $X = \rho_0 c \cdot \frac{H_1(2ka)}{ka}$

这里 $J_1$ 是第一类一阶贝塞尔函数，$H_1$ 是第一类一阶斯特鲁弗函数（Struve function）。

这正是 `radiation_impedance` 函数所计算的量（当 $\rho_0 = c = 1$ 时）。

### 2.3 开口边界条件的推导

在喇叭开口处（$x = L$），声压 $p$ 与质点速度 $v$ 满足：

$$
p = z \cdot v
$$

其中 $z$ 是辐射阻抗率。

由动量方程（线性化欧拉方程）：
$$
\rho_0 \frac{\partial v}{\partial t} = -\frac{\partial p}{\partial x}
$$

对简谐振动 $v(x,t) = v(x) e^{i\omega t}$, $p(x,t) = p(x) e^{i\omega t}$，有：
$$
i\omega \rho_0 v = -\frac{dp}{dx}
$$

即：
$$
\frac{dp}{dx} = -i\omega \rho_0 v
$$

代入 $v = p/z$，得：
$$
\frac{dp}{dx} = -i\omega \rho_0 \frac{p}{z}
$$

或写作：
$$
\frac{dp}{dx} = -\frac{i\omega \rho_0}{z} p
$$

这就是开口处的边界条件（带量纲形式）。

### 2.4 无量纲化

令 $\rho_0 = 1$，$c = 1$，则：
- $k = \omega$
- $z = R + iX$，其中 $R = 1 - \frac{J_1(2\omega a)}{\omega a}$，$X = \frac{H_1(2\omega a)}{\omega a}$

边界条件变为：
$$
\frac{dp}{dx} = -\frac{i\omega}{z} p
$$

进一步，若长度也无量纲化，令 $\tilde{x} = x/L$，$\tilde{p}(\tilde{x}) = p(x)$，则：
$$
\frac{d\tilde{p}}{d\tilde{x}} = L \frac{dp}{dx} = L \cdot \left(-\frac{i\omega}{z}\right) p = -\frac{i\tilde{\omega}}{z} \tilde{p}
$$

其中 $\tilde{\omega} = \omega L = kL$。

在 $\rho_0 = c = 1$ 的约定下，最终无量纲边界条件为：
$$
\frac{d\tilde{p}}{d\tilde{x}} = -\frac{i\tilde{\omega}}{z} \tilde{p}
$$

其中 $z$ 由 `radiation_impedance(a, \omega)` 计算（注意此时 $c=1$，故 $k=\omega$）。

### 2.5 与Webster方程的结合

在喇叭开口处（$x = L$），声压 $p(x)$ 满足Webster方程的空间部分：
$$
\frac{d}{dx} \left( S(x) \frac{dp}{dx} \right) + k^2 S(x) p = 0
$$

以及辐射边界条件：
$$
\frac{dp}{dx} = -\frac{i\omega \rho_0}{z} p
$$

这两个方程共同决定了喇叭内的声场分布和共振频率。

---

## 3. 总结

1. **Webster方程**（喇叭方程）描述了变截面管道中的声波传播：
   $$
   \frac{d}{dx} \left( S(x) \frac{dp}{dx} \right) + k^2 S(x) p = 0
   $$

2. **辐射阻抗** $z = R + iX$ 描述了开口处的声能辐射特性：
   - $R = 1 - \frac{J_1(2ka)}{ka}$（辐射阻）
   - $X = \frac{H_1(2ka)}{ka}$（辐射抗）

3. **开口边界条件**：
   $$
   \frac{dp}{dx} = -\frac{i\omega \rho_0}{z} p
   $$

这些方程构成了分析管乐器声学特性的理论基础，可用于计算共振频率、声场分布和辐射效率等。
